<Window x:Class="RoofTagV3.Views.RoofTagWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="clr-namespace:RoofTagV3.ViewModels"
        xmlns:conv="clr-namespace:RoofTagV3.ViewModels"
        Title="Roof Tag V3 - Revit 2026"
        Height="650" Width="500"
        WindowStartupLocation="CenterScreen"
        ResizeMode="NoResize"
        MinHeight="600" MinWidth="450">

    <Window.Resources>
        <conv:BoolInverseConverter x:Key="BoolInverseConverter"/>
    </Window.Resources>

    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Mode Selection -->
        <GroupBox Header="Tagging Mode" Grid.Row="0" Margin="0,0,0,8">
            <StackPanel Orientation="Horizontal" Margin="8">
                <RadioButton Content="Automatic (Roof Vertices)" 
                           IsChecked="{Binding UseManualMode, Converter={StaticResource BoolInverseConverter}}"
                           Margin="8,4"/>
                <RadioButton Content="Manual Selection" 
                           IsChecked="{Binding UseManualMode}"
                           Margin="8,4"/>
            </StackPanel>
        </GroupBox>

        <!-- Angle Selection -->
        <GroupBox Header="Leader Angle" Grid.Row="1" Margin="0,0,0,8">
            <UniformGrid Columns="3" Margin="8">
                <RadioButton Content="30°" GroupName="AngleGroup"
                           IsChecked="{Binding SelectedAngle, Converter={StaticResource BoolInverseConverter}, ConverterParameter=30}"/>
                <RadioButton Content="45°" GroupName="AngleGroup"
                           IsChecked="{Binding SelectedAngle, Converter={StaticResource BoolInverseConverter}, ConverterParameter=45}"/>
                <RadioButton Content="60°" GroupName="AngleGroup"
                           IsChecked="{Binding SelectedAngle, Converter={StaticResource BoolInverseConverter}, ConverterParameter=60}"/>
            </UniformGrid>
        </GroupBox>

        <!-- Bend Direction -->
        <GroupBox Header="Bend Direction" Grid.Row="2" Margin="0,0,0,8">
            <StackPanel Orientation="Horizontal" Margin="8">
                <RadioButton Content="Inward (Toward Center)" 
                           IsChecked="{Binding BendInward}"
                           Margin="8,4"/>
                <RadioButton Content="Outward (Away from Center)" 
                           IsChecked="{Binding BendInward, Converter={StaticResource BoolInverseConverter}}"
                           Margin="8,4"/>
            </StackPanel>
        </GroupBox>

        <!-- Offsets -->
        <GroupBox Header="Offset Distances (mm)" Grid.Row="3" Margin="0,0,0,8">
            <Grid Margin="8">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <TextBlock Text="Bend Offset:" VerticalAlignment="Center" Margin="0,0,8,0"/>
                <TextBox Grid.Column="1" Text="{Binding BendOffsetMillimeters, UpdateSourceTrigger=PropertyChanged}"
                        VerticalAlignment="Center" Margin="0,0,8,0"/>
                <TextBlock Grid.Column="2" Text="mm" VerticalAlignment="Center"/>

                <TextBlock Grid.Row="1" Text="End Offset:" VerticalAlignment="Center" Margin="0,8,8,0"/>
                <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding EndOffsetMillimeters, UpdateSourceTrigger=PropertyChanged}"
                        VerticalAlignment="Center" Margin="0,8,8,0"/>
                <TextBlock Grid.Row="1" Grid.Column="2" Text="mm" VerticalAlignment="Center" Margin="0,8,0,0"/>
            </Grid>
        </GroupBox>

        <!-- Tag Type -->
        <GroupBox Header="Spot Elevation Type" Grid.Row="4" Margin="0,0,0,8">
            <ComboBox ItemsSource="{Binding SpotTagTypes}"
                     SelectedItem="{Binding SelectedSpotTagType}"
                     DisplayMemberPath="Name"
                     Margin="8" Height="26"/>
        </GroupBox>

        <!-- Options -->
        <StackPanel Grid.Row="5" Orientation="Horizontal" Margin="0,0,0,12">
            <CheckBox Content="Use Leader Line" 
                     IsChecked="{Binding UseLeader}"
                     Margin="8,4" VerticalAlignment="Center"/>
        </StackPanel>

        <!-- Live Log -->
        <GroupBox Header="Live Log" Grid.Row="6" Margin="0,0,0,8">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <ScrollViewer VerticalScrollBarVisibility="Auto" 
                            HorizontalScrollBarVisibility="Auto"
                            Margin="8">
                    <TextBox Text="{Binding LogText, Mode=OneWay}"
                            IsReadOnly="True"
                            FontFamily="Consolas"
                            FontSize="11"
                            TextWrapping="Wrap"
                            BorderThickness="0"
                            Background="Transparent"/>
                </ScrollViewer>

                <Button Grid.Row="1" Content="Clear Log" 
                       HorizontalAlignment="Right" 
                       Margin="8,4,8,8" Padding="8,2"
                       Command="{Binding ClearLogCommand}"/>
            </Grid>
        </GroupBox>

        <!-- Buttons -->
        <StackPanel Grid.Row="7" Orientation="Horizontal" HorizontalAlignment="Right">
            <Button Content="OK" Width="80" Height="26" Margin="8,0" 
                   Click="OnOkClicked" IsDefault="True"/>
            <Button Content="Cancel" Width="80" Height="26" Margin="8,0" 
                   Click="OnCancelClicked" IsCancel="True"/>
        </StackPanel>
    </Grid>
</Window>