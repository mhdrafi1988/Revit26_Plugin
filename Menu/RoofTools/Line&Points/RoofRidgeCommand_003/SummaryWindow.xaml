<Window
    x:Class="Revit22_Plugin.RRLPV3.Views.SummaryWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Processing Summary"
    Width="480"
    Height="420"
    ResizeMode="NoResize"
    WindowStartupLocation="CenterOwner"
    Background="#F5F5F5">

    <Grid Margin="15">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="10"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="10"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Title -->
        <TextBlock Text="{Binding ResultStatus}"
                   FontSize="16"
                   FontWeight="Bold"
                   Foreground="Black"/>

        <!-- Counts -->
        <StackPanel Grid.Row="2" Orientation="Vertical">
            <TextBlock Text="Detail Lines Created:"
                       FontWeight="SemiBold"/>
            <TextBlock Text="{Binding DetailLinesCreated}" Margin="0 0 0 8"/>

            <TextBlock Text="Perpendicular Lines Created:"
                       FontWeight="SemiBold"/>
            <TextBlock Text="{Binding PerpendicularLinesCreated}" Margin="0 0 0 8"/>

            <TextBlock Text="Shape Points Added:"
                       FontWeight="SemiBold"/>
            <TextBlock Text="{Binding ShapePointsAdded}" Margin="0 0 0 8"/>

            <TextBlock Text="Duration:"
                       FontWeight="SemiBold"/>
            <TextBlock Text="{Binding Duration}"/>
        </StackPanel>

        <!-- Log List -->
        <Border Grid.Row="4"
                Background="White"
                BorderBrush="#CCCCCC"
                BorderThickness="1"
                Padding="6">

            <ScrollViewer VerticalScrollBarVisibility="Auto">
                <ItemsControl ItemsSource="{Binding Logs}">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding}" TextWrapping="Wrap" Margin="0 0 0 4"/>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </ScrollViewer>
        </Border>

        <!-- Close Button -->
        <Button Grid.Row="5"
                Content="OK"
                Width="100"
                Height="30"
                HorizontalAlignment="Right"
                Margin="0 10 0 0"
                Click="OnCloseClicked"/>
    </Grid>
</Window>
