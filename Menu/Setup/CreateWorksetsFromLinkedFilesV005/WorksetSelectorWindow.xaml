<Window x:Class="Revit26_Plugin.WSFL_007.Views.WorksetAssignmentWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Workset Assignment"
        Height="650"
        Width="1100"
        WindowStartupLocation="CenterScreen"
        ResizeMode="CanResize">

    <DockPanel Margin="8">

        <!-- ================================================= -->
        <!-- TOP CONTROL ROW                                   -->
        <!-- ================================================= -->
        <Border DockPanel.Dock="Top"
                BorderBrush="#C0C0C0"
                BorderThickness="1"
                Padding="6"
                Margin="0,0,0,6">

            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">

                <!-- + Button -->
                <Button Content="+"
                        Width="28"
                        Height="22"
                        Margin="2"/>

                <!-- Link TextBox -->
                <TextBox Width="120"
                         Height="22"
                         Margin="2"
                         Text="Link"/>

                <!-- ( Name ___ ) -->
                <TextBlock Text=" ( Name "
                           VerticalAlignment="Center"
                           Margin="6,0,2,0"/>

                <TextBox Width="180"
                         Height="22"
                         Margin="0,0,2,0"
                         Text="{Binding WorksetPattern, UpdateSourceTrigger=PropertyChanged}"/>

                <TextBlock Text=" )"
                           VerticalAlignment="Center"
                           Margin="0,0,10,0"/>

                <!-- Selection Buttons -->
                <Button Content="All"
                        Width="60"
                        Height="22"
                        Margin="2"
                        Command="{Binding SelectAllCommand}"/>

                <Button Content="None"
                        Width="60"
                        Height="22"
                        Margin="2"
                        Command="{Binding SelectNoneCommand}"/>

                <Button Content="Reverse"
                        Width="80"
                        Height="22"
                        Margin="2"
                        Command="{Binding ReverseSelectionCommand}"/>

                <!-- Spacer -->
                <Border Width="20"/>

                <!-- Action Buttons -->
                <Button Content="Create WS"
                        Width="100"
                        Height="22"
                        Margin="2"
                        Command="{Binding CreateWorksetsCommand}"/>

                <Button Content="Re-Sync"
                        Width="100"
                        Height="22"
                        Margin="2"
                        Command="{Binding ReSyncCommand}"/>

            </StackPanel>
        </Border>

        <!-- ================================================= -->
        <!-- DATAGRID                                          -->
        <!-- ================================================= -->
        <Border BorderBrush="#5B9BD5"
                BorderThickness="1"
                Padding="1">

            <DataGrid ItemsSource="{Binding Items}"
                      AutoGenerateColumns="False"
                      CanUserAddRows="False"
                      HeadersVisibility="Column"
                      GridLinesVisibility="All"
                      HorizontalScrollBarVisibility="Auto"
                      VerticalScrollBarVisibility="Auto">

                <!-- Row Coloring -->
                <DataGrid.RowStyle>
                    <Style TargetType="DataGridRow">
                        <Style.Triggers>
                            <!-- Green -->
                            <DataTrigger Binding="{Binding State}" Value="Assigned">
                                <Setter Property="Background" Value="#FFDFF2E1"/>
                            </DataTrigger>

                            <!-- Yellow -->
                            <DataTrigger Binding="{Binding State}" Value="WorksetExistsNotAssigned">
                                <Setter Property="Background" Value="#FFFFF3C4"/>
                            </DataTrigger>

                            <!-- Red -->
                            <DataTrigger Binding="{Binding State}" Value="NeedsSync">
                                <Setter Property="Background" Value="#FFF6D0D0"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </DataGrid.RowStyle>

                <DataGrid.Columns>

                    <!-- Checkbox -->
                    <DataGridCheckBoxColumn Width="40"
                                            Binding="{Binding IsSelected}"/>

                    <!-- Link File -->
                    <DataGridTextColumn Header="Link File"
                                        Binding="{Binding LinkName}"
                                        Width="*"/>

                    <!-- Target Workset -->
                    <DataGridTextColumn Header="Target Workset"
                                        Binding="{Binding TargetWorkset}"
                                        Width="*"/>

                </DataGrid.Columns>

            </DataGrid>
        </Border>

        <!-- ================================================= -->
        <!-- LOG AREA (EMPTY LIKE SCREENSHOT, READY TO USE)    -->
        <!-- ================================================= -->
        <Border DockPanel.Dock="Bottom"
                Height="160"
                Margin="0,6,0,0"
                BorderBrush="#C0C0C0"
                BorderThickness="1">

            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="*" />
                    <RowDefinition Height="1.5*" />
                </Grid.RowDefinitions>

                <!-- Live Log -->
                <ListBox Grid.Row="0"
                         ItemsSource="{Binding Log}"
                         FontFamily="Consolas"
                         FontSize="12"/>

                <!-- Copyable Log -->
                <TextBox Grid.Row="1"
                         Text="{Binding LogText}"
                         IsReadOnly="True"
                         AcceptsReturn="True"
                         TextWrapping="Wrap"
                         VerticalScrollBarVisibility="Auto"
                         FontFamily="Consolas"/>
            </Grid>
        </Border>

    </DockPanel>
</Window>
