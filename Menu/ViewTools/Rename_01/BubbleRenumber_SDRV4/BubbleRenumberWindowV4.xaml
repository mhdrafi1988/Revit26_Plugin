<mah:MetroWindow x:Class="Revit26_Plugin.SDRV4.Views.BubbleRenumberWindowV4"
                 xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                 xmlns:mah="http://metro.mahapps.com/winfx/xaml/controls"
                 Title="Bubble Renumber V4"
                 Height="500"
                 Width="520"
                 WindowStartupLocation="CenterOwner"
                 GlowBrush="DodgerBlue">

    <Grid Margin="15">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- SHEET PICKER -->
        <StackPanel Orientation="Horizontal">
            <TextBlock Text="Select Sheet:"
                       VerticalAlignment="Center"
                       Foreground="DodgerBlue"
                       FontWeight="Bold"/>
            <ComboBox ItemsSource="{Binding Sheets}"
                      SelectedItem="{Binding SelectedSheet}"
                      DisplayMemberPath="SheetNumber"
                      Width="220"
                      Margin="10 0"/>
        </StackPanel>

        <!-- INPUT FIELDS -->
        <StackPanel Grid.Row="1" Margin="0 10 0 0">
            <StackPanel Orientation="Horizontal" Margin="0 5">
                <TextBlock Text="Start Number:"
                           Width="150"
                           VerticalAlignment="Center"
                           Foreground="DodgerBlue"/>
                <TextBox Text="{Binding StartingDetailNumber}"
                         Width="90"/>
            </StackPanel>

            <StackPanel Orientation="Horizontal">
                <TextBlock Text="Vertical Threshold (mm):"
                           Width="150"
                           VerticalAlignment="Center"
                           Foreground="DodgerBlue"/>
                <TextBox Text="{Binding VerticalThresholdMm}"
                         Width="90"/>
            </StackPanel>
        </StackPanel>

        <!-- LOG PANEL -->
        <GroupBox Grid.Row="3" Header="Log" Margin="0 15 0 10">
            <ScrollViewer VerticalScrollBarVisibility="Auto">
                <TextBlock Text="{Binding LogText}"
                   FontFamily="Consolas"
                   TextWrapping="Wrap"
                   Foreground="White" />
            </ScrollViewer>
        </GroupBox>


        <!-- RUN BUTTON -->
        <Button Grid.Row="4"
                Content="RENUMBER"
                Command="{Binding RunCommand}"
                Background="DodgerBlue"
                Foreground="White"
                FontWeight="Bold"
                Height="40"
                HorizontalAlignment="Stretch"/>
    </Grid>

</mah:MetroWindow>
