<Window x:Class="Revit22_Plugin.SectionPlacement.SectionPlacementWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Section Placement" Height="520" Width="520" WindowStartupLocation="CenterScreen">

    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Title Block -->
        <StackPanel Orientation="Horizontal" Margin="0,5">
            <TextBlock Text="Title Block:" VerticalAlignment="Center" Width="100"/>
            <ComboBox ItemsSource="{Binding TitleBlocks}" 
                      SelectedItem="{Binding SelectedTitleBlock}" 
                      DisplayMemberPath="Name" Width="350"/>
        </StackPanel>

        <!-- View Template -->
        <StackPanel Orientation="Horizontal" Margin="0,5" Grid.Row="1">
            <TextBlock Text="View Template:" VerticalAlignment="Center" Width="100"/>
            <ComboBox ItemsSource="{Binding ViewTemplates}" 
                      SelectedItem="{Binding SelectedViewTemplate}" 
                      DisplayMemberPath="Name" Width="350"/>
        </StackPanel>

        <!-- Grid Settings -->
        <StackPanel Orientation="Horizontal" Margin="0,5" Grid.Row="2">
            <TextBlock Text="Rows:" VerticalAlignment="Center" Width="50"/>
            <TextBox Text="{Binding Rows}" Width="50" Margin="0,0,10,0"/>
            <TextBlock Text="Cols:" VerticalAlignment="Center" Width="50"/>
            <TextBox Text="{Binding Columns}" Width="50" Margin="0,0,10,0"/>
            <TextBlock Text="X Gap:" VerticalAlignment="Center" Width="50"/>
            <TextBox Text="{Binding XGap}" Width="60" Margin="0,0,10,0"/>
            <TextBlock Text="Y Gap:" VerticalAlignment="Center" Width="50"/>
            <TextBox Text="{Binding YGap}" Width="60"/>
        </StackPanel>

        <!-- Existing Sheets -->
        <GroupBox Header="Select Existing Sheets" Grid.Row="3" Margin="0,10,0,10">
            <ListBox x:Name="SheetsListBox"
                     ItemsSource="{Binding ExistingSheets}" 
                     DisplayMemberPath="SheetNumber"
                     SelectionMode="Extended"
                     Height="200"/>
        </GroupBox>

        <!-- Options + Preview + Buttons -->
        <StackPanel Orientation="Vertical" Grid.Row="4">
            <CheckBox Content="Auto-create new sheets if needed" 
                      IsChecked="{Binding AutoCreateNewSheets}" Margin="0,0,0,10"/>
            <TextBlock Text="{Binding PreviewText}" Margin="0,0,0,10" TextWrapping="Wrap"/>
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                <Button Content="Preview" Width="80" Margin="0,0,10,0" Command="{Binding PreviewCommand}"/>
                <Button Content="OK" Width="80" IsDefault="True" Click="OkButton_Click"/>
                <Button Content="Cancel" Width="80" IsCancel="True"/>
            </StackPanel>
        </StackPanel>
    </Grid>
</Window>
