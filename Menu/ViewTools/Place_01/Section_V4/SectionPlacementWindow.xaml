<Window x:Class="Revit22_Plugin.SectionPlacement.SectionPlacementWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Move Sections to Sheet" Height="600" Width="700"
        WindowStartupLocation="CenterScreen">

    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <!-- Title Block -->
            <RowDefinition Height="Auto"/>
            <!-- View Template -->
            <RowDefinition Height="Auto"/>
            <!-- Grid settings -->
            <RowDefinition Height="*"/>
            <!-- Sections -->
            <RowDefinition Height="Auto"/>
            <!-- Sheets -->
            <RowDefinition Height="Auto"/>
            <!-- Options + Preview -->
        </Grid.RowDefinitions>

        <!-- Title Block -->
        <StackPanel Orientation="Horizontal" Margin="0,5">
            <TextBlock Text="Title Block:" VerticalAlignment="Center" Width="120"/>
            <ComboBox ItemsSource="{Binding TitleBlocks}" 
                      SelectedItem="{Binding SelectedTitleBlock}" 
                      DisplayMemberPath="Name" Width="400"/>
        </StackPanel>

        <!-- View Template -->
        <StackPanel Orientation="Horizontal" Margin="0,5" Grid.Row="1">
            <TextBlock Text="View Template:" VerticalAlignment="Center" Width="120"/>
            <ComboBox ItemsSource="{Binding ViewTemplates}" 
                      SelectedItem="{Binding SelectedViewTemplate}" 
                      DisplayMemberPath="Name" Width="400"/>
        </StackPanel>

        <!-- Grid Settings -->
        <StackPanel Orientation="Horizontal" Margin="0,5" Grid.Row="2">
            <TextBlock Text="Rows:" VerticalAlignment="Center" Width="50"/>
            <TextBox Text="{Binding Rows}" Width="50" Margin="0,0,10,0"/>
            <TextBlock Text="Cols:" VerticalAlignment="Center" Width="50"/>
            <TextBox Text="{Binding Columns}" Width="50" Margin="0,0,10,0"/>
            <TextBlock Text="X Gap:" VerticalAlignment="Center" Width="60"/>
            <TextBox Text="{Binding XGap}" Width="60" Margin="0,0,10,0"/>
            <TextBlock Text="Y Gap:" VerticalAlignment="Center" Width="60"/>
            <TextBox Text="{Binding YGap}" Width="60"/>
        </StackPanel>

        <!-- Sections List -->
        <GroupBox Header="Sections in Active Plan" Grid.Row="3" Margin="0,10,0,10">
            <DataGrid x:Name="SectionsGrid"
                      ItemsSource="{Binding Sections}" 
                      AutoGenerateColumns="False"
                      SelectionMode="Extended"
                      CanUserAddRows="False"
                      CanUserDeleteRows="False"
                      IsReadOnly="False"
                      Height="220">
                <DataGrid.Columns>
                    <!-- Editable label -->
                    <DataGridTextColumn Header="Section Label" 
                                        Binding="{Binding NameLabel, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                        Width="*"/>
                    <!-- Current sheet (readonly) -->
                    <DataGridTextColumn Header="Current Sheet" 
                                        Binding="{Binding CurrentSheet}" 
                                        IsReadOnly="True" 
                                        Width="200"/>
                </DataGrid.Columns>
            </DataGrid>
        </GroupBox>

        <!-- Existing Sheets -->
        <GroupBox Header="Target Sheets" Grid.Row="4" Margin="0,10,0,10">
            <ListBox x:Name="SheetsListBox"
                     ItemsSource="{Binding ExistingSheets}" 
                     DisplayMemberPath="SheetNumber"
                     SelectionMode="Extended"
                     Height="120"/>
        </GroupBox>

        <!-- Options + Preview -->
        <StackPanel Orientation="Vertical" Grid.Row="5">
            <CheckBox Content="Auto-create new sheets if needed" 
                      IsChecked="{Binding AutoCreateNewSheets}" Margin="0,0,0,10"/>
            <TextBlock Text="{Binding PreviewText}" Margin="0,0,0,10" TextWrapping="Wrap"/>
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                <Button Content="Preview" Width="80" Margin="0,0,10,0" Command="{Binding PreviewCommand}"/>
                <Button Content="OK" Width="80" IsDefault="True" Click="OkButton_Click"/>
                <Button Content="Cancel" Width="80" IsCancel="True"/>
            </StackPanel>
        </StackPanel>
    </Grid>
</Window>
